<div class="container mt-4" *ngIf="!cargando && pozo">
  <div class="card shadow-lg p-4 border-0">

    <h2 class="text-center fw-bold mb-4">
      <span style="color: #125FA8;">DETALLE DEL POZO</span>
    </h2>

    <!--//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////-->
<!-- INFORMACIÓN GENERAL -->
<div class="card shadow-sm border-0 mb-4">
  <div class="card-header d-flex justify-content-between align-items-center" style="background-color: #99a3a7; color: white;">
    <span><i class="bi bi-info-circle-fill me-2"></i> Información general del pozo</span>
    <button class="btn btn-sm text-white" style="background-color: #7A57A1;" (click)="mostrarInfoGeneral = !mostrarInfoGeneral">
      {{ mostrarInfoGeneral ? 'Ocultar' : 'Mostrar' }}
    </button>
  </div>

  <div class="card-body" *ngIf="mostrarInfoGeneral">
    <!-- Datos generales -->
    <div class="row g-2">
      <div class="col-md-6" *ngFor="let campo of [
          { label: 'Nombre', value: pozo.nombre_pozo },
          { label: 'Comunidad', value: pozo.comunidad },
          { label: 'Fecha perforación', value: pozo.fecha_perforacion },
          { label: 'Profundidad', value: pozo.profundidad + ' metros' },
          { label: 'Concesión', value: pozo.concesion },
          { label: 'Diámetro del Ademe', value: pozo.diametro_ademe + ' pulgadas' },
          { label: 'Altitud', value: pozo.altitud + ' msnm' },
          { label: 'Ademe ciego', value: pozo.longitud_ademe_ciego + ' metros' },
          { label: 'Ademe ranurado', value: pozo.longitud_ademe_ranurado + ' metros' },
          { label: 'Gasto actual', value: '(se consulta desde mediciones)', italic: true }
        ]">
        <div class="border rounded p-2 h-100 bg-light">
          <div class="fw-bold mb-1">{{ campo.label }}:</div>
          <div [ngClass]="{'fst-italic': campo.italic}">{{ campo.value }}</div>
        </div>
      </div>
    </div>

    <!-- Mapa -->
    <div *ngIf="mapaUrlSegura" class="mt-4">
      <label class="fw-bold">Ubicación en Google Maps:</label>
      <iframe
        width="100%"
        height="250"
        frameborder="0"
        style="border:0"
        [src]="mapaUrlSegura"
        allowfullscreen>
      </iframe>

      <div class="d-flex justify-content-between align-items-center mt-2 flex-wrap gap-2">
        <div class="bg-light border px-3 py-1 rounded">
          <strong>Lat:</strong> {{ pozo.latitud }} <span class="mx-2">|</span> <strong>Lng:</strong> {{ pozo.longitud }}
        </div>
        <a class="btn btn-sm btn-outline-primary"
          [href]="'https://www.google.com/maps?q=' + pozo.latitud + ',' + pozo.longitud"
          target="_blank">
          Ver en Google Maps
        </a>
      </div>
    </div>

    <!-- Botones -->
    <div class="d-flex gap-2 justify-content-end mt-4">
      <a [routerLink]="['/pozos', pozo.id, 'editar']" class="btn text-white" style="background-color: #125FA8;">
        <i class="bi bi-pencil-square"></i> Editar
      </a>
      <button class="btn btn-danger" (click)="eliminarPozo()">
        <i class="bi bi-trash-fill"></i> Eliminar
      </button>
    </div>
  </div>
</div>


<!--//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////-->
    <!-- MOTOR -->
    <div class="card shadow-sm border-0 mb-4">
      <div class="card-header d-flex justify-content-between align-items-center" style="background-color: #99a3a7; color: white;">
        <span><i class="bi bi-gear-fill me-2"></i> Motor</span>
        <button class="btn btn-sm text-white" style="background-color: #7A57A1;" (click)="mostrarMotor = !mostrarMotor">
          {{ mostrarMotor ? 'Ocultar' : 'Mostrar' }}
        </button>
      </div>
      <div class="card-body" *ngIf="mostrarMotor && pozo?.id">
        <app-motor [pozoId]="pozo.id"></app-motor>
      </div>
    </div>

    <!-- TRANSFORMADOR -->
    <div class="card shadow-sm border-0 mb-4">
      <div class="card-header d-flex justify-content-between align-items-center" style="background-color: #99a3a7; color: white;">
        <span><i class="bi bi-lightning-fill me-2"></i> Transformador</span>
        <button class="btn btn-sm text-white" style="background-color: #7A57A1;" (click)="mostrarTransformador = !mostrarTransformador">
          {{ mostrarTransformador ? 'Ocultar' : 'Mostrar' }}
        </button>
      </div>
      <div class="card-body" *ngIf="mostrarTransformador && pozo?.id">
        <app-transformador [pozoId]="pozo.id"></app-transformador>
      </div>
    </div>

    <!-- ARCHIVOS -->
    <div class="card shadow-sm border-0 mb-4">
      <div class="card-header d-flex justify-content-between align-items-center" style="background-color: #99a3a7; color: white;">
        <span><i class="bi bi-folder-fill me-2"></i> Archivos del pozo</span>
        <button class="btn btn-sm text-white" style="background-color: #7A57A1;" (click)="mostrarArchivos = !mostrarArchivos">
          {{ mostrarArchivos ? 'Ocultar' : 'Mostrar' }}
        </button>
      </div>
      <div class="card-body" *ngIf="mostrarArchivos && pozo?.id">
        <app-archivo [pozoId]="pozo.id"></app-archivo>
        <app-lista-archivos [pozoId]="pozo.id"></app-lista-archivos>
      </div>
    </div>

      <!-- MEDICIONES -->
<div class="card shadow-sm border-0 mb-4">
  <div class="card-header d-flex justify-content-between align-items-center" style="background-color: #99a3a7; color: white;">
    <span><i class="bi bi-clipboard2-pulse-fill me-2"></i> Mediciones</span>
    <button class="btn btn-sm text-white" style="background-color: #7A57A1;" (click)="mostrarMediciones = !mostrarMediciones">
      {{ mostrarMediciones ? 'Ocultar' : 'Mostrar' }}
    </button>
  </div>
  <div class="card-body" *ngIf="mostrarMediciones && pozo?.id">
    <app-medicion [pozoId]="pozo.id"></app-medicion>
  </div>
</div>

<app-graficas-medicion [pozoId]="pozo.id"></app-graficas-medicion>

    <!-- BOTÓN REGRESAR -->
    <div class="text-end">
      <a routerLink="/pozos" class="btn text-white mt-3" style="background-color: #125FA8;">
        <i class="bi bi-arrow-left-circle"></i> Regresar
      </a>
    </div>

  </div>
</div>

